<!doctype html>
<html lang="en-US">
<head>
    <meta charset="UTF-8">
    <title>{% block title %}Reanima.store{% endblock %}</title>
    <link rel="stylesheet" href="{{ static_host }}/vendor/pure-min.css">
    <link rel="stylesheet" href="{{ static_host }}/vendor/grids-min.css">
    <link rel="stylesheet" href="{{ static_host }}/vendor/grids-responsive-min.css">
    <link rel="stylesheet" href="{{ static_host }}/vendor/magnific-popup.css">
    <link rel="stylesheet" href="{{ static_host }}/css/main.css">
    <script type="text/javascript" src="{{ static_host }}/vendor/jquery.min.js"></script>
    <script type="text/javascript" src="{{ static_host }}/vendor/jquery.color.js"></script>
    <script type="text/javascript" src="{{ static_host }}/vendor/jquery.magnific-popup.min.js"></script>
    <script type="text/javascript" src="{{ static_host }}/vendor/socket.io.slim.js"></script>
    <script type="text/javascript" src="{{ static_host }}/vendor/js.cookie.js"></script>
    <script type="text/javascript" src="{{ static_host }}/js/main.js"></script>
    <script type="text/javascript">
        var transport = Object.create(transportProto);

//        var connectionRest = Object.create(ajaxConnection);
//        connectionRest.host = document.location.protocol + '//' + document.location.host + '/rest';
//        transport.setConnection(connectionRest, transportProto.REST);

        var connectionRest = Object.create(socketConnection);
        connectionRest.host = document.location.protocol + '//' + document.location.hostname; // + ':9081';
        connectionRest.init({});
        transport.setConnection(connectionRest, transportProto.REST);

        var connectionPage = Object.create(ajaxConnection);
        connectionPage.host = document.location.protocol + '//' + document.location.host;
        connectionPage.type = 'html';
        transport.setConnection(connectionPage, transportProto.PAGE);
        

        transport.call('get', 'rest/auth-user', {}, function (data) {
            if (typeof data.user_id !== 'undefined' && !!data.user_id) {
                transport.call('get', 'rest/user', {id: data.user_id}, function (user) {
                    $("#user-page a").text(user.nickname).attr('href', '/user/' + data.user_id);
                    $("#sign-in").hide();
                    $("#login").show();
                })
            } else {
                $("#sign-in").show();
                $("#user-page").hide();
                $("#login").show();
            }
        });

    </script>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type="text/css">

    </style>
    {% block top_head %}{% endblock %}
</head>
<body>
<div class="header-area main-content-parent">
    <div class="pure-g main-content">
        <div class="pure-u-1-5 menu">
            <div class="logo">
                <a href="/">R-Store</a>
            </div>
        </div>
        <div class="pure-u-4-5 menu" style="">
            <div class="top-menu align-parent">
                <a href="/projects/new/project">+проект</a>
                <a href="/">все проекты</a>
                <span id="login" class="alignright" style="display: none">
                    <span id="sign-in">
                        <a href="/user-auth/" >войти</a>
                    </span>
                    <span id="user-page"> 
                        <a href="/user/me">моя страница</a>
                    </span>
                </span>
            </div>
        </div>
    </div>
</div>
{% block sub_theme %}
    <div class="main-content-parent sub-theme">
        <div class="main-content">
            {% block head_parent %}
                <div class="zero-layer">
                    {% block head %}{% endblock %}
                </div>
            {% endblock %}
        </div>
    </div>
{% endblock %}
<div class="main-content-parent">
    <div class="main-content">
        {% block body %}
        {% endblock %}
    </div>
</div>
<div class="main-content-parent layout-footer">
    <div class="main-content">
        <div class="zero-layer">
            <div class="pure-g layout-footer-links">
                <div class="pure-u-1 pure-u-md-1-3">
                    <h3>Разделы</h3>
                    <ul>
                        <li><a href="/projects/">Все проекты</a></li>
                        <li><a href="/projects/show/best/">Лучише проекты</a></li>
                        <li><a href="/projects/show/newest/">Новые проекты</a></li>
                        <li><a href="/user/all/list/">Участники</a></li>
                    </ul>
                </div>
                <div class="pure-u-1 pure-u-md-1-3">
                    <h3>О проекте</h3>
                    <ul>
                        <li><a href="/product/page/idea/">Идея проекта</a></li>
                        <li><a href="/product/page/team/">Команда</a></li>
                        <li><a href="/product/page/contacts/">Контакты</a></li>
                    </ul>
                </div>
                <div class="pure-u-1 pure-u-md-1-3">
                    <h3>Поддержка</h3>
                    <ul>
                        <li><a href="mailto:contact@herach.online">contact@herach.online</a></li>
                        <li><a href="https://t.me/herach_online" target="_blank">Группа в Telegram</a></li>
                        <li><a href="https://t.me/ho_channel" target="_blank">Канал в Telegram</a></li>
                    </ul>
                </div>
                <div class="pure-u-1 pure-u-md-1-3"></div>
            </div>
        </div>
    </div>
</div>

{% if env.debug %}
    <div class="main-content-parent" style="height: 20vh;" id="logs-root-container">
        <div class="main-content">
            <div class="logs-footer">
                <div class="pure-g">
                    <div id="logs-expand" class="pure-u-1-2"></div>
                    <div id="logs-close" class="pure-u-1-2"></div>
                </div>
                <div class="">
                </div>
                <div id="logs-container"></div>
                <script>
                    $("#logs-expand").bind('click', function () {
                        console.log('logs-expand');
                        $(".logs-footer").toggleClass('logs-footer-open');
                    });

                    $("#logs-close").bind('click', function () {
                        console.log('logs-close');
                        $("#logs-root-container").remove();
                    });

                    transport.loadPage('get', 'dev/dev-logs', {"id": "{{ request_id }}"}, function (data) {
                        $("#logs-container").html(data);
                    });
                </script>
            </div>
        </div>
    </div>
{% endif %}
<script type="text/javascript" src="{{ static_host }}/js/autosave.js"></script>
<script type="text/javascript">
    nav.init();
</script>
</body>
</html>
